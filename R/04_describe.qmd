---
title: "07 decribtive statistics"
output: html_document
---

# Load Libraries

```{r}
library(tidyverse)
library(here)
```

## Load data

```{r}
describe_dat_aug_01 <- read.csv(here("data/03_dat_aug_01.csv"))
describe_dat_aug_03 <- read.csv(here("data/03_dat_aug_03.csv"))
describe_dat_aug_04 <- read.csv(here("data/03_dat_aug_04.csv"))
```

## Data description

### Amount of genes investigated in the experiment

```{r}
#number of genes (observations)
describe_dat_aug_01 |> 
  dim()
```

there is 784 variables which means there is 784 different genes in the experiment

### Amount of classes and genes in each class

```{r}
#which different classes the genes are in 
describe_dat_aug_01 |>
  group_by(code_class) |> 
  count()
  summarise(n = n()) 

describe_dat_aug_01 |>
  ggplot(aes(x = code_class)) +
  geom_bar() + 
  labs(
    title = "Histogram of Classes",
    x = "Classes",
    y = "Number of Genes"
  ) +
  theme_minimal()

```

There is four different classes: endogenous, housekeeping, negative and positive.\
There is 750 genes in endogenous, 20 genes in housekeeping, 8 genes in negative and 6 genes in positive

### Amount of pre-treatment and post-treatment experiments

```{r}
describe_dat_aug_01 |> 
    select(starts_with("pre")) |> 
  ncol()

describe_dat_aug_01 |> 
    select(starts_with("post")) |> 
  ncol()
```

There is five columns (variables) containing data from pre-treatment experiment and vice verse for post-treatment. This mean there was done 10 experiments, five before treatment and five after treatment.

### Density plot of gene expression by code class in pre and post conditions

```{r}
ggplot(data = describe_dat_aug_04, aes(x = mean_count, fill = code_class)) +
  geom_density(alpha = 0.5) +
  theme_minimal() +
  scale_x_log10() +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25)) +
  facet_wrap("type") +
  labs(title = "Density Plot of code plass",
       x = "Mean expression ",
       y = "Density")
```

This plot assess the variation in gene expression and observe any shifts between the "pre" and "post" conditions across the different code classes. The "negative" genes does general have low ekspression

### The genes there is most up regulated and down regulated in terms of fold change before and after treatment

```{r}
#The 2% most upregulated and the 2% most downregulated after treatment for each class are plottet. Here you can see which genes are most up regulated and downregulated after treatment from each class. 
describe_dat_aug_03 |> 
  group_by(code_class) |> 
 mutate(
  biggest_fold_change = case_when(
    log2_fold_change <= quantile(log2_fold_change, 0.02, na.rm = TRUE) ~ "low",
    log2_fold_change >= quantile(log2_fold_change, 0.98, na.rm = TRUE) ~ "high",
    TRUE ~ "middle")
  ) |> 
  filter(biggest_fold_change %in% c("high", "low")) |> 
  ggplot(mapping = aes(x = gene,
                       y = log2_fold_change)) + 
  geom_point(aes(color = code_class)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Which genes are it exactly ? 

```{r}
describe_dat_aug_03 |> 
  group_by(code_class) |> 
 mutate(
  biggest_fold_change = case_when(
    log2_fold_change <= quantile(log2_fold_change, 0.02, na.rm = TRUE) ~ "low",
    log2_fold_change >= quantile(log2_fold_change, 0.98, na.rm = TRUE) ~ "high",
    TRUE ~ "middle")
  ) |> 
  filter(biggest_fold_change %in% c("high", "low")) |> 
  arrange(desc(log2_fold_change)) #from highest log2fold change to lowest

>>>>>>> b2623145364077a28790a583fc49045c14ddac4d
```
